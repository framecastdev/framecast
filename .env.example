# Framecast API Configuration Template
# Copy this file to .env and fill in your actual values
# Following 12-Factor Rule III: Config - Store config in environment variables

# ============================================================================
# CORE APPLICATION SETTINGS
# ============================================================================

# Application Environment
ENVIRONMENT=development
LOG_LEVEL=info
RUST_LOG=framecast=debug,sqlx=warn
PORT=3000
HOST=0.0.0.0

# CORS Configuration
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
CORS_MAX_AGE=3600

# ============================================================================
# DATABASE CONFIGURATION (Backing Service IV)
# ============================================================================

# Primary Database (Supabase PostgreSQL)
DATABASE_URL=postgresql://postgres:password@localhost:5432/framecast_dev
DATABASE_MAX_CONNECTIONS=10
DATABASE_MIN_CONNECTIONS=1
DATABASE_ACQUIRE_TIMEOUT=30
DATABASE_IDLE_TIMEOUT=600

# Connection Pooling
PGBOUNCER_ENABLED=false
PGBOUNCER_POOL_SIZE=25

# ============================================================================
# AUTHENTICATION & AUTHORIZATION (Supabase Auth)
# ============================================================================

# Supabase Configuration
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-supabase-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key

# JWT Configuration
JWT_SECRET=your-jwt-secret-key
JWT_EXPIRES_IN=86400
JWT_ALGORITHM=HS256

# ============================================================================
# EXTERNAL SERVICE APIS (Backing Services IV)
# ============================================================================

# Anthropic Claude API (LLM Service)
ANTHROPIC_API_KEY=your-anthropic-api-key
ANTHROPIC_BASE_URL=https://api.anthropic.com
ANTHROPIC_MODEL=claude-3-sonnet-20240229
ANTHROPIC_MAX_TOKENS=4000
ANTHROPIC_TIMEOUT=30

# RunPod GPU Compute (Video Generation)
RUNPOD_API_KEY=your-runpod-api-key
RUNPOD_ENDPOINT_ID=your-runpod-endpoint-id
RUNPOD_BASE_URL=https://api.runpod.ai
RUNPOD_TIMEOUT=300
RUNPOD_MAX_RETRIES=3

# Inngest Job Orchestration
INNGEST_EVENT_KEY=your-inngest-event-key
INNGEST_SIGNING_KEY=your-inngest-signing-key
INNGEST_DEV_SERVER_URL=http://localhost:8288
INNGEST_PROD_URL=https://api.inngest.com

# ============================================================================
# OBJECT STORAGE (S3 Compatible)
# ============================================================================

# AWS S3 Configuration
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-aws-access-key-id
AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key

# S3 Buckets
S3_BUCKET_OUTPUTS=framecast-outputs-prod
S3_BUCKET_ASSETS=framecast-assets-prod
S3_PRESIGNED_URL_EXPIRES=3600

# LocalStack (Development Only)
# When using LocalStack, set these for local development:
# AWS_ENDPOINT_URL=http://localhost:4566
# S3_BUCKET_OUTPUTS=framecast-outputs-dev
# S3_BUCKET_ASSETS=framecast-assets-dev

# ============================================================================
# JOB PROCESSING & ORCHESTRATION
# ============================================================================

# Job Configuration
MAX_CONCURRENT_JOBS_STARTER=1
MAX_CONCURRENT_JOBS_TEAM=5
MAX_JOB_TIMEOUT=1800
JOB_CLEANUP_INTERVAL=3600

# Video Generation Settings
MAX_VIDEO_DURATION=300
MAX_SCENES_PER_VIDEO=20
DEFAULT_VIDEO_QUALITY=1080p
SUPPORTED_FORMATS=mp4,mov,webm

# ComfyUI Configuration
COMFYUI_WORKFLOW_TIMEOUT=600
COMFYUI_MAX_RETRIES=2
COMFYUI_PROGRESS_POLL_INTERVAL=5

# ============================================================================
# RATE LIMITING & QUOTAS
# ============================================================================

# API Rate Limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST=20
RATE_LIMIT_WINDOW=60

# User Quotas
STARTER_MONTHLY_CREDITS=100
CREATOR_MONTHLY_CREDITS=1000
TEAM_BASE_MONTHLY_CREDITS=5000

# Storage Quotas (in MB)
STARTER_STORAGE_QUOTA=1000
CREATOR_STORAGE_QUOTA=10000
TEAM_STORAGE_QUOTA=100000

# ============================================================================
# WEBHOOK & NOTIFICATIONS
# ============================================================================

# Webhook Configuration
WEBHOOK_TIMEOUT=30
WEBHOOK_MAX_RETRIES=5
WEBHOOK_RETRY_BACKOFF=exponential
WEBHOOK_RETRY_BASE_DELAY=1000

# Email Configuration (if using direct SMTP)
EMAIL_PROVIDER=supabase
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=your-smtp-username
SMTP_PASSWORD=your-smtp-password
FROM_EMAIL=invitations@framecast.app

# LocalStack Email Testing (for development and testing)
LOCALSTACK_EMAIL_ENABLED=true
LOCALSTACK_SES_URL=http://localhost:4566
EMAIL_RETRIEVAL_ENABLED=true
EMAIL_RETRIEVAL_TIMEOUT=10

# ============================================================================
# SECURITY & MONITORING
# ============================================================================

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_POLICY=default-src 'self'; script-src 'self' 'unsafe-inline'

# API Security
API_KEY_LENGTH=32
API_KEY_PREFIX=fc_
REQUIRE_HTTPS=false

# Session Management
SESSION_TIMEOUT=3600
SESSION_CLEANUP_INTERVAL=600

# ============================================================================
# OBSERVABILITY & LOGGING
# ============================================================================

# Distributed Tracing
JAEGER_ENABLED=false
JAEGER_ENDPOINT=http://localhost:14268/api/traces
JAEGER_SERVICE_NAME=framecast-api

# Metrics
PROMETHEUS_ENABLED=false
PROMETHEUS_PORT=9090

# Health Check Configuration
HEALTH_CHECK_TIMEOUT=5
HEALTH_CHECK_INTERVAL=30

# Structured Logging
LOG_FORMAT=json
LOG_INCLUDE_LOCATION=true
LOG_INCLUDE_SPANS=true

# ============================================================================
# DEVELOPMENT & TESTING
# ============================================================================

# Development Mode Settings
DEV_MODE=true
HOT_RELOAD=true
MOCK_EXTERNAL_SERVICES=true

# Testing Configuration
TEST_DATABASE_URL=postgresql://postgres:password@localhost:5432/framecast_test
TEST_S3_BUCKET=framecast-test
TEST_SKIP_MIGRATIONS=false

# E2E Testing
E2E_BASE_URL=http://localhost:3000
E2E_TEST_USER_EMAIL=test@framecast.com
E2E_TEST_USER_PASSWORD=test-password
E2E_TIMEOUT=30000

# LocalStack Email Testing Configuration
TEST_LOCALSTACK_SES_URL=http://localhost:4566
TEST_EMAIL_RETRIEVAL_ENABLED=true
TEST_EMAIL_RETRIEVAL_TIMEOUT=10
TEST_EMAIL_CLEANUP_ENABLED=true

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Feature Toggles
FEATURE_TEAM_INVITATIONS=true
FEATURE_WEBHOOKS=true
FEATURE_REAL_TIME_UPDATES=true
FEATURE_ADVANCED_ANALYTICS=false
FEATURE_API_VERSIONING=true

# Experimental Features
EXPERIMENTAL_BATCH_PROCESSING=false
EXPERIMENTAL_AI_ENHANCEMENTS=false

# ============================================================================
# INFRASTRUCTURE SETTINGS
# ============================================================================

# Lambda Configuration (Production)
LAMBDA_MEMORY_SIZE=512
LAMBDA_TIMEOUT=300
LAMBDA_RESERVED_CONCURRENCY=100

# CloudWatch Configuration
CLOUDWATCH_LOG_GROUP=/aws/lambda/framecast-api
CLOUDWATCH_LOG_RETENTION_DAYS=14

# Load Balancer Configuration
ALB_HEALTH_CHECK_PATH=/health
ALB_HEALTH_CHECK_INTERVAL=30
ALB_HEALTH_CHECK_TIMEOUT=5

# ============================================================================
# THIRD-PARTY INTEGRATIONS
# ============================================================================

# Payment Processing (Future)
# STRIPE_PUBLISHABLE_KEY=pk_test_...
# STRIPE_SECRET_KEY=sk_test_...
# STRIPE_WEBHOOK_SECRET=whsec_...

# Analytics (Future)
# MIXPANEL_TOKEN=your-mixpanel-token
# GOOGLE_ANALYTICS_ID=GA-...

# Support & Help Desk (Future)
# ZENDESK_SUBDOMAIN=your-subdomain
# ZENDESK_EMAIL=support@framecast.com
# ZENDESK_TOKEN=your-zendesk-token

# ============================================================================
# ENVIRONMENT-SPECIFIC OVERRIDES
# ============================================================================

# These will be different per environment:
#
# Development:
#   DATABASE_URL -> Local PostgreSQL or Supabase dev
#   AWS_ENDPOINT_URL -> http://localhost:4566 (LocalStack)
#   INNGEST_DEV_SERVER_URL -> http://localhost:8288
#   MOCK_EXTERNAL_SERVICES=true
#
# Staging:
#   DATABASE_URL -> Staging Supabase instance
#   S3_BUCKET_* -> staging-* buckets
#   INNGEST_PROD_URL -> https://api.inngest.com
#   MOCK_EXTERNAL_SERVICES=false
#
# Production:
#   DATABASE_URL -> Production Supabase instance
#   S3_BUCKET_* -> production buckets
#   REQUIRE_HTTPS=true
#   DEV_MODE=false
#   LOG_LEVEL=warn
